{% extends "base.html" %}
{% load static %}

{% block content %}
 <div class="main-wrapper">
     <div class="page-wrapper">
        <div class="content content-two create-project">
            <div class="container mt-4">
                <h2>Edit Item to PO: {{ item.po }}</h2><br>
            
                {% if messages %}
                    {% for message in messages %}
                        <div class="alert alert-{{ message.tags }}">{{ message }}</div>
                    {% endfor %}
                {% endif %}
            
                <form method="POST" id="editItemForm">
                    {% csrf_token %}
            
                    <!-- Order Item -->
                    <div class="mb-3">
                        <label for="order_item" class="form-label">Description</label>
                        <textarea name="description" class="form-control" required>{{ item.description }}</textarea>
                    </div>
            
                    <!-- Workers -->
                    <div class="mb-3">
                        <label for="workers" class="form-label">Quantity:</label>
                        <input type="number" name="quantity" min="1" class="form-control" value="{{ item.quantity }}" required>
                    </div>
            
                    <!-- Deadline -->
                    <div class="mb-3">
                        <label for="deadline" class="form-label">Unit Price</label>
                        <input type="number" name="unit_price" step="0.01" value="{{ item.unit_price }}" class="form-control" required>
                    </div>
            
                    <!-- Submit -->
                    <button type="submit" class="btn btn-primary">Update Item</button>
                    <button type="button" class="btn btn-secondary clsrfsh">Cancel</button>
                    
                </form>
            </div>
        </div>
     </div>
 </div>


 <!-- jQuery -->
    <script src="{% static 'js/jquery-3.7.1.min.js' %}" type=""></script>

    <!-- Bootstrap Core JS -->
    <script src="{% static 'js/bootstrap.bundle.min.js' %}" type="ac3f8615a263811875ad4144-text/javascript"></script>

    <!-- Slimscroll JS -->
    <script src="{% static 'js/jquery.slimscroll.min.js' %}" type="ac3f8615a263811875ad4144-text/javascript"></script>

    <!-- Select2 JS -->
    <script src="{% static 'plugins/select2/js/select2.min.js' %}" type="ac3f8615a263811875ad4144-text/javascript"></script>

    <!-- Datetimepicker JS -->
    <script src="{% static 'js/moment.min.js' %}" type="ac3f8615a263811875ad4144-text/javascript"></script>
    <script src="{% static 'js/bootstrap-datetimepicker.min.js' %}" type="ac3f8615a263811875ad4144-text/javascript"></script>

    <!-- Custom JS -->
    <script src="{% static 'js/script.js' %}" type="ac3f8615a263811875ad4144-text/javascript"></script>

    <script src="{% static 'cdn-cgi/scripts/7d0fa10a/cloudflare-static/rocket-loader.min-2.js' %}" data-cf-settings="ac3f8615a263811875ad4144-|49" defer=""></script>


<script>
document.getElementById('editItemForm').addEventListener('submit', async function(e){
    e.preventDefault();
    const formData = new FormData(this);

    const response = await fetch("", {
        method: "POST",
        body: formData
    });

    const data = await response.json();
    if (data.success) {
        alert(data.message);
        window.location.href = "{% url 'managementSystem:view_po' item.po.id %}"; // go back after edit
    } else {
        alert("Error updating item!");
    }
});
</script>

 <script>
    $('.clsrfsh').click(function(){
        window.location.href = "{% url 'managementSystem:view_po' item.po.id %}";
    });
</script>
{% endblock %}
