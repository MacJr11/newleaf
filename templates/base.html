<!DOCTYPE html>
<html lang="en">
<head>
    {% load static %}
    <meta charset="UTF-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Clockfie is a powerful time tracking admin dashboard template designed for businesses, freelancers, and teams. Track work hours, manage productivity, and streamline payroll with ease using this feature rich and user-friendly template.">
    <meta name="keywords" content="time tracking, time management, productivity tracking, employee time tracker, work hours management, Clockfie, time tracking dashboard, admin template, project tracking, payroll management">
    <meta name="author" content="Dreams Technologies">
    <meta name="robots" content="index, follow">

    <link rel="shortcut icon" href=" {% static 'img/nlogo.png'%} ">

    <!-- Apple Icon -->
    <link rel="apple-touch-icon" href=" {% static 'img/apple-icon.png'%}">


    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="{% static 'css/bootstrap.min.css'%} ">

    <!-- Datatable CSS -->
    <link rel="stylesheet" href="{% static 'css/dataTables.bootstrap5.min.css' %}">
    

    <!-- Daterangepikcer CSS -->
    <link rel="stylesheet" href=" {% static 'plugins/daterangepicker/daterangepicker.css'%}">

    <!-- Tabler Icon CSS -->
    <link rel="stylesheet" href="{% static 'plugins/tabler-icons/tabler-icons.min.css'%} ">


    <!-- Select2 CSS -->
    <link rel="stylesheet" href="{% static 'plugins/select2/css/select2.min.css'%} ">

    <!-- Fontawesome CSS -->
    <link rel="stylesheet" href=" {% static 'plugins/fontawesome/css/fontawesome.min.css'%} ">
    <link rel="stylesheet" href=" {% static 'plugins/fontawesome/css/all.min.css'%} ">

      <link rel="stylesheet" href="{% static 'plugins/intltelinput/css/intlTelInput.css' %}">

    <!-- Main CSS -->
    <link rel="stylesheet" href="{% static 'css/style.css' %} ">
    <link rel="shortcut icon" type="image/x-icon" href="{% static 'img/nlogof.png' %}">

    <title>NewLeaf</title>
</head>
    {% block header %}
        <div class="main-wrapper">  
            <div class="header">
                <div class="main-header">

                    <div class="header-left">
                        <a href="{% url 'dashboard:dashboard' %}" class="logo" style="width: 100px;">
                            <img src=" {% static 'img/nlogo.png' %} " alt="Logo">
                        </a>
                        <a href="{% url 'dashboard:dashboard' %}" class="dark-logo">
                            <img src=" {% static 'img/nlogo.png' %} " alt="Logo">
                        </a>
                    </div>

                    <a id="mobile_btn" class="mobile_btn" href="#sidebar">
                        <span class="bar-icon">
                        <span></span>
                        <span></span>
                        <span></span>
                        </span>
                    </a>

                    <div class="header-user">
                        <div class="nav user-menu nav-list">
                            <div class="me-auto d-flex align-items-center" id="header-search">
                                <a id="toggle_btn" href="javascript:void(0);">
                                    <i class="ti ti-chevron-left"></i>
                                </a>
                                <span class="badge badge-md bg-soft-primary badge-time d-inline-flex align-items-center" id="clock">
                                    <i class="ti ti-clock me-1"></i></span>
                                    <div class="dropdown add-dropdown me-3" style="margin-left: 20px;">
                                        <a href="#" class="btn btn-md d-inline-flex align-items-center" data-bs-toggle="dropdown">
                                            <i class="ti ti-plus me-1"></i>Add New
                                        </a>
                                        <ul class="dropdown-menu dropdown-menu-start p-2">
                                            <li><a class="dropdown-item d-flex align-items-center" href=" {% url 'workers:worker_list' %}"><i class="ti ti-user me-2"></i>Employee</a></li>
                                            <li><a class="dropdown-item d-flex align-items-center" href="{% url 'managementSystem:register_client' %}"><i class="ti ti-users-plus me-2"></i>Client</a></li>
                                            <li><a class="dropdown-item d-flex align-items-center" href="{% url 'managementSystem:create_order' %}"><i class="ti ti-progress-check me-2"></i>Purchase Order</a></li>
                                        </ul>
                                    </div>
                            </div>

                            <div class="d-flex align-items-center">

                                <!-- Search -->
                                <!-- <div class="input-group input-group-flat d-inline-flex me-2">
                                    <span class="input-icon-addon">
                                    <i class="ti ti-search"></i>
                                    </span>
                                    <input type="text" class="form-control" placeholder="Search">
                                    <span class="input-group-text">
                                    <kbd class="bg-gray-100 px-2">CTRL + / </kbd>
                                    </span>
                                </div> -->
                                <!-- /Search -->

                                <!-- Flag -->
                                
                                <!-- /Flag -->

                                <!-- <div class="me-2 nav-item  dropdown theme-item">
                                    <a class="btn btn-menubar" data-bs-toggle="dropdown" href="javascript:void(0);" role="button">
                                        <i class="ti ti-sun-high"></i>
                                    </a>
                                    <ul class="dropdown-menu p-2">
                                        <li class="mb-1">
                                            <a href="javascript:void(0);" class="dropdown-item d-inline-flex align-items-center active theme-toggle" id="light-mode-toggle">
                                                <i class="ti ti-sun-high me-2"></i>Light
                                            </a>
                                        </li>
                                        <li>
                                            <a href="javascript:void(0);" class="dropdown-item d-inline-flex align-items-center theme-toggle" id="dark-mode-toggle">
                                                <i class="ti ti-moon me-2"></i>Dark
                                            </a>
                                        </li>
                                    </ul>
                                </div> -->
                                <div class="me-2 notification_item">
                                    <a class="nav-link" href="#" id="notificationDropdown" data-bs-toggle="dropdown">
                                        <i class="ti ti-bell" style="font-size: 25px;"></i>
                                        {% if unread_notifications > 0 %}
                                            <span class="" style="font-size: 15px; font-weight: bolder; position: absolute; top: 0; color: red;">{{ unread_notifications }}</span>
                                        {% endif %}
                                    </a>

                                     <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="notificationDropdown">
                                        {% if navbar_notifications %}
                                            {% for note in navbar_notifications %}
                                               <a href="{% url 'managementSystem:notifications_list' %}">
                                                   <li class="dropdown-item {% if not note.is_read %}fw-bold{% endif %}">
                                                       {{ note.message }}
                                                       <br>
                                                       <small class="text-muted">{{ note.created_at|date:"M d, H:i" }}</small>
                                                   </li>
                                               </a>
                                            {% endfor %}
                                            <li><hr class="dropdown-divider"></li>
                                            <li><a class="dropdown-item text-center" href="{% url 'managementSystem:notifications_list' %}">View All</a></li>
                                            <div class="dropdown-footer text-center">
                                                <button id="markAllRead" class="btn btn-sm btn-primary" style="width: 100%;">Mark all as read</button>
                                            </div>
                                        {% else %}
                                            <li class="dropdown-item text-center text-muted">No notifications</li>
                                        {% endif %}
                                    </ul>
                                </div>

                                <div class="dropdown profile-dropdown">
                                    <a href="javascript:void(0);" class="dropdown-toggle d-flex align-items-center" data-bs-toggle="dropdown" data-bs-auto-close="outside">
                                        <span class="avatar avatar-md">
                                            <img src="{% static 'img/user.png' %}" alt="Img" class="img-fluid rounded-circle">
                                        </span>
                                    </a>
                                    <div class="dropdown-menu p-2">
                                        <div class="profileset d-flex align-items-center bg-dark p-3 mb-2">
                                            <span class="user-img me-2">
                                                <img src="{% static 'img/user.png' %}" alt="">
                                            </span>
                                            <div>
                                                <h6 class="text-white mb-1">{{ request.user.username }}</h6>
                                                <p class="fs-13 text-light">Manager</p>
                                            </div>
                                        </div>
                                        <a class="dropdown-item logout d-flex align-items-center" href="{% url 'logout' %}">
                                            <i class="ti ti-logout me-2"></i>Signout
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Mobile Menu -->
                    <div class="dropdown mobile-user-menu profile-dropdown">
                        <a href="javascript:void(0);" class="dropdown-toggle d-flex align-items-center" data-bs-toggle="dropdown" data-bs-auto-close="outside">
                            <span class="avatar avatar-md online">
                                <img src="{% static 'img/user.png' %}" alt="Img" class="img-fluid rounded-circle">
                            </span>
                        </a>
                        <div class="dropdown-menu p-2 mt-0">
                            <i class="ti ti-user me-2"></i>{{ request.user.username }}
                            <a class="dropdown-item logout d-flex align-items-center" href="{% url 'logout' %}">
                                <i class="ti ti-logout me-2"></i>Signout
                            </a>
                        </div>
                    <div class="dropdown mobile-user-menu nav-link" style="margin-right: 40px; margin-top: 5px;">
                        <a class="nav-link" href="#" id="notificationDropdown" data-bs-toggle="dropdown">
                            <i class="ti ti-bell" style="font-size:25px;"></i>
                            {% if unread_notifications > 0 %}
                                <span class="" style="font-size: 15px; font-weight: bolder; position: absolute; top: 0; color: red;">{{ unread_notifications }}</span>
                            {% endif %}
                        </a>

                        <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="notificationDropdown">
                            {% if navbar_notifications %}
                                {% for note in navbar_notifications %}
                                    <li class="dropdown-item {% if not note.is_read %}fw-bold{% endif %}">
                                       <a href="{% url 'managementSystem:notifications_list' %}">
                                           {{ note.message }}
                                           <br>
                                           <small class="text-muted">{{ note.created_at|date:"M d, H:i" }}</small>
                                       </a>
                                    </li>
                                {% endfor %}
                                <li><hr class="dropdown-divider"></li>
                                <li><a class="dropdown-item text-center" href="{% url 'managementSystem:notifications_list' %}">View All</a></li>
                                <div class="dropdown-footer text-center">
                                    <button id="markAllRead" class="btn btn-sm btn-primary" style="width:100%;">Mark all as read</button>
                                </div>
                            {% else %}
                                <li class="dropdown-item text-center text-muted">No notifications</li>
                            {% endif %}
                        </ul>
                    </div>
                    <!-- /Mobile Menu -->

                </div>
            </div>
            <!-- /Header -->

            <!-- Sidebar -->
            <div class="sidebar" id="sidebar">
                <!-- Logo -->
                <div class="sidebar-logo">
                    <a href="{% url 'dashboard:dashboard' %}" class="logo logo-normal" style="width:110px; margin-top: -10px;">
                        <img src=" {% static 'img/nlogo.png' %}" alt="Logo">
                    </a>
                    <a href="{% url 'dashboard:dashboard' %}" class="logo logo-small">
                        <img src="{% static 'img/nlogo.png' %}" alt="Logo">
                    </a>
                    <a href="{% url 'dashboard:dashboard' %}" class="dark-logo">
                        <img src="{% static 'img/nlogo.png' %}" alt="Logo">
                    </a>
                </div>
                <!-- /Logo -->
                <div class="sidebar-header p-3 pb-0">
                    <div class="rounded bg-light p-2 mb-3 sidebar-profile d-flex align-items-center">
                        <div class="avatar online avatar-md onlin">
                            <img src=" {% static 'img/profiles/avatar-16.jpg' %}" alt="Img" class="img-fluid rounded-circle">
                        </div>
                        <div class="text-start sidebar-profile-info ms-2">
                            <h6 class="fs-12 fw-normal">{{ request.user.username }}</h6>
                            <p class="fs-10">System Admin</p>
                        </div>
                    </div>
                    <div class="me-auto d-flex align-items-center mb-3">
                        <div class="dropdown add-dropdown me-2">
                            <a href="#" class="btn btn-md border d-inline-flex align-items-center fs-12 px-2" data-bs-toggle="dropdown">
                                <i class="ti ti-plus me-1 text-gray-5"></i>Add New
                            </a>
                            <ul class="dropdown-menu dropdown-menu-start p-2" stytle="z-index: 10;">
                                <li><a class="dropdown-item d-flex align-items-center" href="employees.html"><i class="ti ti-user me-2"></i>Employee</a></li>
                                <li><a class="dropdown-item d-flex align-items-center" href="teams.html"><i class="ti ti-users-plus me-2"></i>Team</a></li>
                                <li><a class="dropdown-item d-flex align-items-center" href="projects.html"><i class="ti ti-progress-check me-2"></i>Projects</a></li>
                                <li><a class="dropdown-item d-flex align-items-center" href="users.html"><i class="ti ti-users me-2"></i>Users</a></li>
                                <li><a class="dropdown-item d-flex align-items-center" href="manual-time.html"><i class="ti ti-clock me-2"></i>Manual Time</a></li>
                            </ul>
                        </div>
                        <span class="btn btn-md btn-time px-2 d-inline-flex align-items-center fs-12 bg-primary-100 text-primary">
                            <i class="ti ti-clock me-1"></i><a href="{% url 'logout' %}">Logout</a>
                        </span>
                    </div>                    
                </div>
                <div class="sidebar-inner slimscroll">
                    <div id="sidebar-menu" class="sidebar-menu">
                        <ul>
                            <li class="menu-title"><span>Main</span></li>
                            <li>
                                <ul>
                                    <li>
                                        <a href="{% url 'dashboard:dashboard' %}" target="_self">
                                            <i class="ti ti-layout-grid-add"></i><span>Dashboard</span>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="{% url 'workers:worker_list' %}" target="_self">
                                            <i class="ti ti-users"></i><span>Workers</span>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="{% url 'managementSystem:register_client' %}" target="_self">
                                            <i class="ti ti-settings-2"></i><span>Clients</span>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="{% url 'managementSystem:orders' %}" target="_self">
                                            <i class="ti ti-layout"></i><span>Purchase Order</span>
                                        </a>
                                    </li>
                                </ul>
                            </li>
                            <li class="menu-title"><span>Analysis</span></li>
                            <li>
                                <ul>
                                    <li>
                                        <a href="{% url 'managementSystem:reports_view' %}">
                                            <i class="ti ti-chart-infographic"></i><span>Report</span>
                                        </a>
                                    </li>
                                </ul>
                            </li>
                            <li class="menu-title"><span>Backup & Restore</span></li>
                            <li>
                                <ul>
                                    <li>
                                        <a href="{% url 'managementSystem:backup' %}">
                                            <i class="ti ti-cloud"></i><span>Backup</span><span class="track-icon"></span>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="{% url 'managementSystem:restore' %}" onclick="return confirm('Are you sure you want to restore the database? This will overwrite current data! Backup current data' )">
                                            <i class="ti ti-restore"></i><span>Restore</span>
                                        </a>
                                    </li>
                                </ul>

                            </li>
                        </ul>
                        <div class="sidebar-footer">
                            <p class="fs-13 copyright">Copyright 2025 - <a href="https://www.behance.net/macdevbiz" class="link-primary">Macdev</a></p>
                        </div>
                    </div>
                </div>
            </div> 
        </div>



        <script>
            function updateClock() {
                const now = new Date();
                document.getElementById("clock").textContent =
                    now.toLocaleTimeString(); // shows HH:MM:SS
            }
            setInterval(updateClock, 1000); // update every second
            updateClock(); // run immediately



            document.addEventListener("DOMContentLoaded", function () {
                const markAllBtn = document.getElementById("markAllRead");
                if (markAllBtn) {
                    markAllBtn.addEventListener("click", function () {
                        fetch("{% url 'managementSystem:mark_all_notifications_read' %}", {
                            method: "POST",
                            headers: {
                                "X-CSRFToken": "{{ csrf_token }}",
                            },
                        })
                        .then(response => response.json())
                        .then(data => {
                            if (data.success) {
                                // Clear unread count badge
                                document.getElementById("notification-count").innerText = "0";
                                // Optionally update styles
                                document.querySelectorAll(".notification-item").forEach(item => {
                                    item.classList.remove("unread");
                                    window.location.reload();
                                });
                            }
                        });
                    });
                }
            });
        </script>


    
    
    {% endblock %}

    {% block  content %}


    {% endblock  %}



 